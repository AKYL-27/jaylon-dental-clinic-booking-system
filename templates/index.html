<!doctype html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" lang=""> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" lang=""> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" lang=""> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang=""> <!--<![endif]-->
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Dashboard - Jaylon Dental Clinic</title>
    <meta name="description" content="Ela Admin - HTML5 Admin Template">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="icon" href="{{ url_for('static', filename='assets/images/clinic-logo2.png') }}" type="image/x-icon"/>

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/normalize.css@8.0.0/normalize.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/lykmapipo/themify-icons@0.1.2/css/themify-icons.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pixeden-stroke-7-icon@1.2.3/pe-icon-7-stroke/dist/pe-icon-7-stroke.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.0/css/flag-icon.min.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/style.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='assets/css/cs-skin-elastic.css') }}">
    <!-- <script type="text/javascript" src="https://cdn.jsdelivr.net/html5shiv/3.7.3/html5shiv.min.js"></script> -->
    <link href="https://cdn.jsdelivr.net/npm/chartist@0.11.0/dist/chartist.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/jqvmap@1.5.1/dist/jqvmap.min.css" rel="stylesheet">

    <link href="https://cdn.jsdelivr.net/npm/weathericons@2.1.0/css/weather-icons.css" rel="stylesheet" />
    <link href="https://cdn.jsdelivr.net/npm/fullcalendar@3.9.0/dist/fullcalendar.min.css" rel="stylesheet" />

   <style>
    #weatherWidget .currentDesc {
        color: #ffffff!important;
    }
        .traffic-chart {
            min-height: 335px;
        }
        #flotPie1  {
            height: 150px;
        }
        #flotPie1 td {
            padding:3px;
        }
        #flotPie1 table {
            top: 20px!important;
            right: -10px!important;
        }
        .chart-container {
            display: table;
            min-width: 270px ;
            text-align: left;
            padding-top: 10px;
            padding-bottom: 10px;
        }
        #flotLine5  {
             height: 105px;
        }

        #flotBarChart {
            height: 150px;
        }
        #cellPaiChart{
            height: 160px;
        }

        /* Additional styles for better screen filling */
        html, body {
            height: 100%;
            margin: 0;
            padding: 0;
        }
        
        #right-panel {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .content {
            flex: 1;
            padding: 30px 20px;
            min-height: calc(100vh - 120px);
        }
        
        /* Keep original card spacing */
        .card {
            margin-bottom: 30px;
        }
        
        /* Appointments table styling */
        .appointments-card {
            min-height: 500px;
            display: flex;
            flex-direction: column;
        }
        
        .appointments-card .card-body {
            flex: 1;
            max-height: 450px;
            overflow-y: auto;
        }
        
        .list-group-item {
            padding: 18px 20px;
            border-left: 4px solid transparent;
            transition: all 0.3s ease;
        }
        
        .list-group-item:hover {
            background-color: #f8f9fa;
            border-left-color: #007bff;
        }
        
        /* Widget stats - keep original size */
        
        /* Footer spacing */
        .site-footer {
            margin-top: auto;
            padding: 20px 0;
        }
        
        /* Scrollbar styling for appointment lists */
        .appointments-card .card-body::-webkit-scrollbar {
            width: 8px;
        }
        
        .appointments-card .card-body::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        .appointments-card .card-body::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 4px;
        }
        
        .appointments-card .card-body::-webkit-scrollbar-thumb:hover {
            background: #555;
        }
        
        /* Empty state styling */
        .empty-state {
            padding: 60px 20px;
            text-align: center;
            color: #6c757d;
        }
        
        .empty-state i {
            font-size: 3rem;
            margin-bottom: 15px;
            opacity: 0.3;
        }

    </style>
</head>

<body>
    <!-- Left Panel -->
    <aside id="left-panel" class="left-panel">
        <nav class="navbar navbar-expand-sm navbar-default">
            <div id="main-menu" class="main-menu collapse navbar-collapse">
                <ul class="nav navbar-nav">
                    <li class="active">
                        <a href="{{url_for ('index')}}"><i class="menu-icon fa fa-laptop"></i>Dashboard </a>
                    </li>

                    <li class="menu-title">Components</li><!-- /.menu-title -->

                    <li class="">
                        <a href="{{url_for ('appointments')}}"><i class="menu-icon fa fa-check-square-o"></i>Appointments </a>
                    </li>

                    <!--<li class="">
                        <a href="{{url_for ('inbox')}}"><i class="menu-icon fa fa-envelope-o"></i>Messenger Inbox </a>
                    </li>-->

                    <li class="">
                        <a href="{{url_for ('payments')}}"><i class="menu-icon fa fa-credit-card"></i> Payments </a>
                    </li>

                    <li class="">
                        <a href="{{url_for ('services')}}"><i class="menu-icon fa fa-pencil-square-o"></i> Services </a>
                    </li>
                    <li><a href="{{url_for('patient_history')}}"><i class="menu-icon fa fa-history"></i>Patient History</a></li>
                    <li><a href="{{ url_for('reports') }}"><i class="menu-icon fa fa-bar-chart"></i>Reports</a></li>


                    <li>
                        <a href="{{ url_for('calendar') }}"><i class="menu-icon fa fa-calendar"></i> Calendar</a>
                    </li>


                </ul>
            </div><!-- /.navbar-collapse -->
        </nav>
    </aside>
    <!-- /#left-panel -->
    <!-- Right Panel -->
    <div id="right-panel" class="right-panel">
        <!-- Header-->
        <header id="header" class="header">
            <div class="top-left">
                <div class="navbar-header">
                    <a class="navbar-brand" href="./"><img src="{{ url_for('static', filename='assets/images/clinic-logo.png') }} " alt="Logo"></a>
                    <a class="navbar-brand hidden" href="./"><img src="{{ url_for('static', filename='assets/images/clinic-logo2.png') }} " alt="Logo"></a>
                    <a id="menuToggle" class="menutoggle"><i class="fa fa-bars"></i></a>
                </div>
            </div>
            <div class="top-right">
                <div class="header-menu">

                    <div class="user-area dropdown float-right">
                        <a href="#" class="dropdown-toggle active" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            <img class="user-avatar rounded-circle" src="{{ url_for('static', filename='assets/images/default-profile.png') }}" alt="User Avatar">
                        </a>

                        <div class="user-menu dropdown-menu">
                            <a class="nav-link" href="{{url_for ('profile')}}"><i class="fa fa- user"></i>My Profile</a>
                            <a class="nav-link" href="{{ url_for('logout') }}"><i class="fa fa-power -off"></i>Logout</a>
                        </div>
                    </div>

                </div>
            </div>
        </header>
        <!-- /#header -->
        
        <!-- Content -->
        <div class="content">
            <!-- Animated -->
            <div class="animated fadeIn">
                <!-- Widgets  -->
                <div class="row">
                    <div class="col-lg-3 col-md-6">
                        <div class="card">
                            <div class="card-body">
                                <div class="stat-widget-five">
                                    <div class="stat-icon dib flat-color-1">
                                        <i class="ti-pin-alt"></i>
                                    </div>
                                    <div class="stat-content">
                                        <div class="text-left dib">
                                            <div class="stat-text"><span class="count">{{ today_appointments|length }}</span></div>
                                            <div class="stat-heading">Today Schedules</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-3 col-md-6">
                        <div class="card">
                            <div class="card-body">
                                <div class="stat-widget-five">
                                    <div class="stat-icon dib flat-color-3">
                                        <i class="ti-calendar"></i>
                                    </div>
                                    <div class="stat-content">
                                        <div class="text-left dib">
                                            <div class="stat-text"><span class="count">{{ upcoming_appointments|length }}</span></div>
                                            <div class="stat-heading">Upcoming Schedules</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-3 col-md-6">
                        <div class="card">
                            <div class="card-body">
                                <div class="stat-widget-five">
                                    <div class="stat-icon dib flat-color-4">
                                        <i class="ti-credit-card"></i>
                                    </div>
                                    <div class="stat-content">
                                        <div class="text-left dib">
                                            <div class="stat-text"><span class="count">{{ pending_payments|length }}</span></div>
                                            <div class="stat-heading">Pending Payments</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-lg-3 col-md-6">
                        <div class="card">
                            <div class="card-body">
                                <div class="stat-widget-five">
                                    <div class="stat-icon dib flat-color-2">
                                        <i class="ti-info-alt"></i>
                                    </div>
                                    <div class="stat-content">
                                        <div class="text-left dib">
                                            <div class="stat-text"><span class="count">{{ cancelled_appointments|length }}</span></div>
                                            <div class="stat-heading">Cancelled Schedules</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /Widgets -->

                <div class="clearfix"></div>
                
                <!-- Appointments Tables -->
                <div class="orders">
                    <div class="row">
                        <!-- Today Appointments -->
                        <div class="col-xl-6">
                            <div class="card shadow-sm appointments-card">
                                <div class="card-header" style="
                                    background-color: #f0f8ff; 
                                    border-bottom: 1px solid #b0c4de; 
                                    padding: 15px 20px; 
                                    border-radius: 5px 5px 0 0;">
                                    <h4 class="mb-0 font-weight-bold" style="font-size: 1.3rem; letter-spacing: 0.5px;">
                                        <i class="fa fa-calendar-check-o mr-2"></i>Today Appointments
                                    </h4>
                                </div>
                                <div class="card-body p-0">
                                    {% if today_appointments %}
                                        <ul class="list-group list-group-flush">
{% for appt in today_appointments|sort(attribute='time') %}
    <li class="list-group-item d-flex justify-content-between align-items-center">
        <div>
            <strong style="font-size: 1.05rem;">{{ appt.fullname }}</strong>
            {% if appt.status == 'rescheduled' %}
                <span class="badge badge-warning badge-sm ml-2">Rescheduled</span>
            {% endif %}
            <br>
            <small class="text-muted"><i class="fa fa-medkit mr-1"></i>{{ appt.service }}</small>
        </div>
        <div class="text-right">
            <span class="badge badge-primary" style="font-size: 0.9rem; padding: 8px 12px;">
                <i class="fa fa-clock-o mr-1"></i>{{ appt.time_display }}
            </span>
        </div>
    </li>
{% endfor %}                                        </ul>
                                    {% else %}
                                        <div class="empty-state">
                                            <i class="fa fa-calendar-o"></i>
                                            <p class="mb-0">No appointments scheduled for today.</p>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>

                        <!-- Upcoming Appointments -->
                        <div class="col-xl-6">
                            <div class="card shadow-sm appointments-card">
                                <div class="card-header" style="
                                    background-color: #f5fff0; 
                                    border-bottom: 1px solid #c6e2b3; 
                                    padding: 15px 20px; 
                                    border-radius: 5px 5px 0 0;">
                                    <h4 class="mb-0 font-weight-bold" style="font-size: 1.3rem; letter-spacing: 0.5px;">
                                        <i class="fa fa-calendar mr-2"></i>Upcoming Appointments (Next 7 days)
                                    </h4>
                                </div>
                                <div class="card-body p-0">
                                    {% if upcoming_appointments %}
                                        <ul class="list-group list-group-flush">
{% for appt in upcoming_appointments|sort(attribute='date')|sort(attribute='time') %}
    <li class="list-group-item d-flex justify-content-between align-items-center">
        <div>
            <strong style="font-size: 1.05rem;">{{ appt.fullname }}</strong>
            {% if appt.status == 'rescheduled' %}
                <span class="badge badge-warning badge-sm ml-2">Rescheduled</span>
            {% endif %}
            <br>
            <small class="text-muted"><i class="fa fa-medkit mr-1"></i>{{ appt.service }}</small>
        </div>
        <div class="text-right">
            <span class="badge badge-success" style="font-size: 0.85rem; padding: 6px 10px;">
                <i class="fa fa-calendar-o mr-1"></i>{{ appt.date }}
            </span><br>
            <small class="text-muted mt-1 d-inline-block">
                <i class="fa fa-clock-o mr-1"></i>{{ appt.time_display }}
            </small>
        </div>
    </li>
{% endfor %}                                        </ul>
                                    {% else %}
                                        <div class="empty-state">
                                            <i class="fa fa-calendar-times-o"></i>
                                            <p class="mb-0">No upcoming appointments scheduled.</p>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- /.orders -->
            </div>
            <!-- .animated -->
        </div>
        <!-- /.content -->
        
        <div class="clearfix"></div>
        
        <!-- FOOTER -->
        <footer class="site-footer">
            <div class="footer-inner bg-white">
                <div class="row">
                    <div class="col-sm-6">Copyright Â© 2025 Jaylon Dental Clinic</div>
                </div>
            </div>
        </footer>
        <!-- /.site-footer -->
    </div>
    <!-- /#right-panel -->

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@2.2.4/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.4/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.1.3/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-match-height@0.7.2/dist/jquery.matchHeight.min.js"></script>
    <script src="{{ url_for('static', filename='assets/js/main.js') }}"></script>


    <script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/moment.min.js"></script>

</body>
</html>
